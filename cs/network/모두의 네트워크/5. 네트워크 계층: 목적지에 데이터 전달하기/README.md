# 네트워크 간의 연결 구조
다른 네트워크에 있는 목적지로 데이터를 전달하려면 네트워크 계층의 기술이 필요하다.  
데이터 링크 계층에서는 이더넷 규칙을 기반으로 데이터의 전송을 담당한다.  
이 규칙에 따라 같은 네트워크에 있는 컴퓨터로는 데이터를 전송할 수 있지만 인터넷이나 다른 네트워크로는 데이터를 전송할 수 없다.  
4장에서 살펴본 스위치를 사용하면 다른 컴퓨터로 데이터를 전송할 수 있지만 같은 네트워크안에서만 가능하다.  
네트워크 간의 통신을 가능하게 하는것이 네트워크 계층의 역할이다.  

# 라우터
위에서 말한 네트워크 간의 통신을 가능하게 하는 장비가 라우터이다.  
라우터는 데이터의 목적지가 정해지면 해당 목적지까지 어떤 경로로 가는것이 좋은지를 알려주는 기능을한다.  
랜에서는 MAC 주만으로도 통신할 수 있지만 다른네트워크에는 데이터를 보낼 수 없다.  
그래서 MAC 주소가 아닌 네트워크를 식별할 수 있는 다른 주소가 필요한데 이것을 IP 주소라고한다.

# DHCP
DHCP는 네트워크에 연결된 컴퓨터에 IP 주소를 자동으로 할당해주는 프로토콜이다.

# 라우팅
IP 주소로 목적지를 지정하고 데이터를 어떤경로로 보낼지를 결정하는것을 라우팅이라고한다.

# 라우팅 테이블
라우팅 테이블은 라우터에 저장되어 있는 목적지까지의 경로 정보이다.

# IP 주소
IP 주소는 네트워크 계층에서 어떤 네트워크의 어떤 컴퓨터인지를 구분할 수 있도록 하는 주소이다.  
네트워크 계층에서 캡슐화할때 IP 헤더를 붙인다.
1. 버전(version)
2. 헤더 길이(header length
3. 서비스 유형(service type)
4. 전체 패킷 길이(헤더 + 데이터)
5. ID(identification, 식별자)
6. 조각 상태(flags)
7. 조각의 위치(fragment offset)
8. TTL(time to live)
9. 헤더 체크섬
10. 출발지 IP
11. 목적지 IP

순서로 헤더 정보가 구성된다.
이렇게 IP 프로토콜을 사용하여 캡슐화할 때는 IP 헤더가 추가되는데 이걸 IP 패킷이라고한다.
데이터링크에서는 캡슐화할때 프레임이라는 단어를 사용한다.  
IP 주소는 ISP로부터 할당받는다.

# IPv4와 IPv6
현재 주로 사용하고 있다.
32비트로 되어 있어 약 43억개를 만들 수 있다.  
인터넷 초기에는 43억개면 충분하다고 생각이 들었으나 인터넷이 보급되면서 부족해지자 Ipv6 주소를 사용하게 되었다.  
IPv6는 128비트로 되어있어 약 340간개를 만들 수 있다. -> 340조의 1조 배의 1조배

# 공인 IP 주소와 사설 IP 주소
공인 IP 주소는 인터넷 서비스 제공자(ISP)로부터 할당받는 IP 주소이다.  
인터넷에 직접 연결되는 컴퓨터나 라우터에는 공인 IP주소를 할당하고 회사나 가정의 랜에 있는 컴퓨터는 사설 IP 주소를 할당한다.
2진수의 32비트로 되어있는데 8비트씩 4개로 나누어서 표현한다.
MAC 주소는 48비트로 16진수로 표시하고, IP 주소는 32비트로 10진수로 표시한다.  
```java
11000000(1옥텟).10101000(2옥텟).00000001(3옥텟).00001010(4옥텟)
```
8비트는 옥텟이라고 부르기도 한다. 위의 주소를 10진수로 표현하면 다음과 같다.
192.168.1.10

# 2진수를 10진수로 변환하는 방법
11000000
1. 2의 7승을 곱한다. 1 * 2^7 = 128
2. 2의 6승을 곱한다. 1 * 2^6 = 64
3. 2의 5승을 곱한다. 0 * 2^5 = 0
4. 2의 4승을 곱한다. 0 * 2^4 = 0
5. 2의 3승을 곱한다. 0 * 2^3 = 0
6. 2의 2승을 곱한다. 0 * 2^2 = 0
7. 2의 1승을 곱한다. 0 * 2^1 = 0
8. 2의 0승을 곱한다. 0 * 2^0 = 0
9. 128 + 64 + 0 + 0 + 0 + 0 + 0 + 0 = 192

2진수의 범위는 00000000 ~ 11111111 이므로 10진수로는 0 ~ 255까지 표현할 수 있다.

# 네트워크 ID와 호스트 ID
- 네트워크 ID : 네트워크를 식별하는데 사용하는 부분
- 호스트 ID : 해당 네트워크의 호스트를 식별하는데 사용하는 부분

# IP 주소 클래스
IPv4의 IP 주소는 32비트이다.  
비트로 구분하지만 네트워크 ID를 크게만들거나 호스트 ID를 작게 만들어 네트워크 크기를 조정할 수도 있다.  
네트워크 크기는 클래스라는 개념으로 구분하고 있다.  
클래스는 네트워크 ID의 크기에 따라 A, B, C, D, E로 구분한다.

|클래스|내용|
|---|---|
|A 클래스| 대규모 네트워크 주소|
|B 클래스| 중간 규모 네트워크 주소|
|C 클래스| 소규모 네트워크 주소|
|D 클래스| 멀티캐스트 주소|
|E 클래스| 연구용 주소|

일반 네트워크에서는 A ~ C 클래스까지 사용할 수 있다.

## A 클래스
A 클래스는 1옥텟(8비트)를 네트워크 ID로 사용한다.
1. 첫 번째 옥텟의 첫 번째 비트가 0이므로 1 ~ 127까지 사용할 수 있다.
2. 첫 번째 옥텟을 네트워크 ID로 사용하므로 호스트 ID는 3옥텟(24비트)이다.
3. 2~4 옥텟의 범위는 각각 2진수로 00000001 ~ 11111111이고 이것을 10진수로 변환하면 0~255가 된다.
4. 1.0.0.0 ~ 127.255.255.255

## B 클래스
B 클래스는 2옥텟(16비트)를 네트워크 ID로 사용한다.
1. 첫 번째 옥텟과 두 번째 옥텟을 네트워크 ID로 사용하므로 호스트 ID는 2옥텟(16비트)이다.
2. 1옥탯의 범위는 2진수로 10000000 ~ 10111111이고 이것을 10진수로 변환하면 128 ~ 191가 된다.
3. 32비트 전체 범위는 128.0.0.0~191.255.255.255이다.

## C 클래스
C 클래스는 3옥텟(24비트)를 네트워크 ID로 사용한다.
1. 첫 번째 옥텟과 두 번째 옥텟, 세 번째 옥텟을 네트워크 ID로 사용하므로 호스트 ID는 1옥텟(8비트)이다.
2. 1옥탯의 범위는 2진수로 11000000 ~ 11011111이고 이것을 10진수로 변환하면 192 ~ 223가 된다.
3. 32비트 전체 범위는 192.0.0.0~223.255.255.255이다.

보통 가정의 랜에서 사용한다.

## 공인 IP 주소의 범위
|종류 | 공인 IP 주소의 범위                                              |
|---|-----------------------------------------------------------|
|A 클래스| 1.0.0.0 ~ 9.255.255.255<br/>11.0.0.0 ~ 126.255.255.255    |
|B 클래스| 128.0.0.0~172.15.255.255<br/>172.32.0.0~191.255.255.255   |
|C 클래스| 192.0.0.0~192.167.255.255<br/>192.169.0.0~223.255.255.255 |

## 사설 IP 주소의 범위
|종류 | 사설 IP 주소의 범위                                              |
|---|-----------------------------------------------------------|
|A 클래스| 10.0.0.0 ~ 10.255.255.255|
|B 클래스| 172.16.0.0 ~ 172.31.255.255|
|C 클래스| 192.168.0.0 ~ 192.168.255.255|

# 네트워크 주소와 브로드 캐스트 주소
이 두 주소는 특별한 주소로 컴퓨터나 라우터가 자신의 IP로 사용하면 안된다.  
네트워크 주소는 호스트 ID가 10진수로 0이고 2진수면 00000000인 주소이다.  
브로트캐스트 주소는 호스트 ID가 10진수로 255이고 2진수면 11111111인 주소이다.

## 네트워크 주소
네트워크 주소는 전체 네트워크에서 작은 네트워크를 식별하는데 사용되고 호스트 ID가 0이면 그 네트워크 전체를 대표하는 주소가 된다.  
예를들어 네트워크 주소가 192.168.1.1 ~ 192.168.1.6개의 IP를 가진 컴퓨터는 192.168.1.0(네트워크 주소)의 네트워크에 있는 것이다.  

## 브로드캐스트 주소
브로드캐스트 주소는 네트워크에 있는 컴퓨터나 장비 모두에게 한 번에 데이터를 전송하는데 사용되는 전용 IP 주소이다.  
192.168.1.255 로 데이터를 전송하면 네트워크 안에 있는 모든 컴퓨터가 데이터를 받게 된다.

# 서브넷
네트워크를 분할하는것을 서브넷팅이라고한다.  
대규모 네트워크를 작은 네트워크로 나누어서 관리할 수 있게 된다.  
분할된 네트워크를 서브넷이라고 한다.  
A 클래스는 1옥텟(8비트)를 네트워크 ID로 사용하고 3옥텟(24비트)를 호스트 ID로 사용한다.  
이 상태를 서브네팅하면 네트워크 ID, 서브넷 ID, 호스트 ID로 나눌 수 있다. -> 호스트 ID를 서브넷 ID로 사용한다.  

# 서브넷 마스크
서브넷 마스크는 네트워크 ID와 호스트 ID를 구분하는데 사용되는 32비트의 이진수이다.  
A 클래스는 255.0.0.0, B 클래스는 255.255.0.0, C 클래스는 255.255.255.0이 된다.

# 프리픽스(슬래시) 표기법
서브넷 마스크를 10진수로 표기하면 255.255.255.0이지만 슬래시 표기법으로 표기하면 /24가 된다.
C 클래스는 24비트를 네트워크 ID로 사용하고 8비트를 호스트 ID로 사용한다.  
호스트 ID에서 4비트 빌려 서브넷 ID 4비트를 만들게된다.
네트워크 ID + 서브넷 ID = 서브넷 마스크  
예를들어 192.168.1.0일때
서브넷 마스크는 255.255.255.240 인데 이걸 프리픽스 표기법으로 바꾸면 /28이 된다.  

# 라우터
서로 다른 네트워크와 통신하려면 라우터가 필요하다.  
라우터는 네트워크를 분리할 수 있다.
스위치는 같은 네트워크 안에서만 통신이 가능하지만 라우터는 네트워크를 분리할 수 있기 때문에 다른 네트워크와도 통신이 가능하다.

# 기본 게이트웨이
라우터를 통해 네트워크를 분리하면 192.168.1.1이 하나의 네트워크(A)이고 192.168.2.1가 또 하나의  네트워크(B)가 된다.    
A네트워크의 192.168.1.1의 컴퓨터에서 B 네트워크의 192.168.2.1의 데이터를 전송하려면 라우터의 IP 주소를 설정해야한다. 이걸 기본 게이트웨이라고한다.
컴퓨터 1은 다른 네트워크로 데이터를 보낼 때 어디로 전송해야 하는지 모르기 때문에 네트워크의 출입구를 지정하고 일단은 라우터로 데이터를 전송한다.  

# 라우팅 테이블이 등록하는 방법

## 수동으로 등록한느 방법
소규모 네트워크에 적합하다.

## 자동으로 등록하는 방법
대규모 네트워크에 적합하다.

## 라우팅 프로토콜
라우터 간에 경로 정보를 서로 교환하여 라우팅 테이블 정보를 자동으로 수정해준다.  
이처럼 라우터 간에 라우팅 정보를 교환하기 위한 프로토콜을 라우팅 프로토콜이라고한다.

# 정리
- 서로 다른 네트워크 간에 통신을 하려면 라우터가 필요하다.
- 랜 안에서는 MAC 주소만으로 토인할 수 있지만 네트워크 간에 통신을 하려면 IP 주소가 필요하다.
- 경로를 선택하고 목적지 IP 주소를 설정하는것을 라우팅이라고한다.
- 네트워크 계층의 대표적인 프로토콜에는 IP가 있다.
- IP 주소는 인터넷 서비스 공급자에게 할당받을 수 있다.
- IP 주소는 공인 IP 주소와 사설 IP 주소로 나눌 수 있다.
- 공인 IP 주소는 인터넷에 직접 연결되는 컴퓨터나 라우터에 할당하고 사설 IP 주소는 회사나 가정의 랜에 있는 컴퓨터에 할당한다.
- IP 주소는 A ~ E 클래스로 나눌 수 있다. 일반적으로 A ~ C 클래스를 사용한다.
- 네트워크 주소와 브로드캐스트 주소는 컴퓨터에 설정할 수 없다.
- 네트워크를 분할하는 것을 서브넷팅이라고 하고 분할된 네트워크를 서브넷이라고한다.
- 서브넷팅되면 구성이 네트워크 ID, 서브넷 ID, 호스트 ID로 나눌 수 있다.
- 서브넷 마스크는 네트워크 주소와 호스트 주소를 식별하는 값이다.
- 프리픽스 표기법은 서브넷마스크를 슬래시(/비트)로 나타낸다. 255.255.255.0 -> /24
- 컴퓨터에서 다른 네트워크로 데이터를 전송하려면 기본 게이트웨이를 설정해야한다.
- 라우팅은 최적의 경로를 통해 데이터를 전송하는 방식이다.
- 경로 정보가 등록되어 있는 테이블을 라우팅 테이블이라고 한다.
- 라우터 간에 라우팅 정볼르 서로 교환하기 위한 프로토콜을 라우팅 프로토콜이라고 한다.
