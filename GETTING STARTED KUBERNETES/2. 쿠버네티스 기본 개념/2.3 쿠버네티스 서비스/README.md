# 2.3 쿠버네티스 서비스
파드는 쿠버네티스 클러스터 안에서 옮겨 다니는 특성이 있다.  
파드가 실행 중인 워커 노드에 문제가 생기면 다른 워커 노드에서 파드가 다시 생성 될 수 있고 그때마다 IP가 변경되는 특셩이 있다.
이렇게 동적으로 변하는 파드에 고정된 방법으로 접근하기 위해서 사용되는 것이 서비스이다.  
서비스를 사용하면 파드가 클러스터 내의 어디에 떠 있든지 고정된 주소를 이용해 접근할 수 있다. 그리고 클러스터 외부에서 파드에 접근할 수도 있다.

# 쿠버네티스 서비스의 유형

## 클러스터 IP(Cluster IP)
쿠버네티스 클러스터 내의 파드들은 기본적으로 외부에서 접근할 수 있는 IP를 할당 받지 않는다.  
하지만 같은 클러스터 내부에서는 파드들이 통신할 방법을 제공하는데 바로 그것이 클러스터IP이다.  
즉 클러스터 내의 모든 파드가 해당 클러스터 IP 주소로 접근할 수 있다.

## 노드포트(NodePort)
서비스를 외부로 노출 할 때 사용한다. 노드 포트로 서비스를 노출하기 위해 워커 노드의 IP와 포트를 이용한다.  
예를 들어 워커 노드의 IP가 192.168.2.3이고 30010이라는 특정 포트를 사용한다면, 외부에서 192.168.2.3:30010으로 접근할 수 있다.

## 로드밸런서(LoadBalancer)
로드밸런서는 주로 퍼블릭 클라우드에 존재하는 로드밸런서에 연결하고자 할 때 사용한다. 이때 사용자는 로드밸런서의 외부IP(external IP)를 통해 접근한다.

# 서비스의 매니페스트
```yaml
apiVersion: v1 # 쿠버네티스 API 버전
kind: Service # 서비스 작업으로 명시
metadata:
  name: service-test # 서비스 이름 설정
spec:
  type: ClusterIP # 서비스 유형 설정 정의하기도하고 안하기도 함
  selector:
    app: webserver # 워커 노드애 떠 있는 컨테이너 중 webserver를 외부에 노출
  ports:
    - protocol: TCP # 프로토콜 설정
    port: 80 # 서비스 포트 설정
    targetPort: 80 # 컨테이너 포트 설정
```
